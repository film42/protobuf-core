#!/usr/bin/env ruby

$LOAD_PATH << ::File.expand_path("../../lib", __FILE__)

require 'protobuf/compiler/protoc_channel'

# Send on fifo channel to parent
request_bytes = STDIN.read
::Protobuf::Compiler::ProtocChannel.send(request_bytes)

# Receive compiled bytes and send to protoc
response_bytes = ::Protobuf::Compiler::ProtocChannel.receive
STDOUT.print(response_bytes)
